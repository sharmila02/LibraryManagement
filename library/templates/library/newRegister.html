<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-10">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha3104-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <style>
      *{
        padding: 0;
        margin: 0;
        box-sizing: border-box;

      }
      body{
        background-image: linear-gradient(to top, #09203f 0%, #537895 100%);
        

      }
      .row{
        background:white;
        margin-top: 2%;
        width: max-content;
        padding-left: 5%;
        padding-right: 5%;
        
      }
      .btn1{
        border: none;
        outline: none;
        height: 50px;
        width: 100%;
        background-color: black;
        color: white;
        padding-bottom: 2px;
      }
      .btn1:hover{
        background-color: white;
        color: black;
        border: 2px solid #09203f;
      }
      .img-fluid{
        height: 100%;
      }
    </style>
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    
  </head>
  <body onload="getLocation()">
    <center>
     <section class="Form ">
      <div class="container">
        <div class="row ">
          <!-- <div class="col-lg-5   " >
            <img src="https://cdni.iconscout.com/illustration/premium/thumb/user-account-sign-up-44109360-3723267.png" class="img-fluid mt-1 mb-5" alt="">
          </div> -->
          
          <div class="col">
            <center>
            <h3 style="padding-top: 1%;">Signup</h3>
            </center>
            <hr>
            <!-- <form action="" id="signup" method="POST">
              {% csrf_token %} -->
              <div class="form-row">
                <div class="col-lg-12 ">
                  <input type="text" placeholder="Institute Name" name="instituteName"  id="test-instituteName" class="form-control" required >
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                  <input type="text" placeholder="Institute Phone Number"  name="phone" id="test-phone_no" class="form-control" pattern="([0-9]{4}-[0-9]{7}|[0-9]{10})" required>
                  <span id="error" style="display: None;">Phone Number not valid</span>
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12  pt-3">
                  <select class="form-control" name="role" id="test-role" required>
                    <option value="">Institute Type</option>
                    <option value="reader">Individual Building</option>
                    <option value="publisher">Residential Building Floor</option>
                    <option value="staff">Apartment Floor</option>
                    <option value="staff">Other</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="col-lg-12  pt-3">
                  <select class="form-control" name="cat" id="test-cat" required>
                    <option value="">Institute Category</option>
                    <option value="reader">School</option>
                    <option value="publisher">Sachivalay</option>
                    <option value="staff">E-Seva</option>
                    <option value="staff">Other</option>
                  </select>
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                  <input type="number" placeholder="Area covered by institute(in sqkms)" step="1" name="area" id="test-area" class="form-control" required >
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                  <input type="number" placeholder="Size(No. of buildings under institute)" step="1" name="size" id="test-size" class="form-control" required >
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                    <input type="number" min="1900" max="2022" step="1" placeholder="Year Of Construction" name="estdyear" id="test-estdyear" class="form-control" required />
                </div>
              </div>

            
              <div class="form-row">
                <div class="col-lg-12 pt-3">
                    <input type="number" step="1" placeholder="Capacity(Maximum number of people that can be acommadated)" name="capacity" id="test-capacity" class="form-control" required />
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                    <input type="number" step="1" placeholder="Number of Rooms" name="rooms" id="test-rooms" class="form-control" required />
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                    <input type="number" step="1" placeholder="Number of Labs" name="labs" id="test-labs" class="form-control" required />
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                  <input type="text" placeholder="Address Line"  name="address"  id="test-address"class="form-control" required>
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                  <input type="text" placeholder="City"  name="city"  id="test-city"class="form-control" required>
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                  <input type="text" placeholder="State"  name="state"  id="test-state"class="form-control" required>
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                  <input type="number" placeholder="Pin Code"  name="pincode"  id="test-pincode" class="form-control"  pattern="[0-9]{6}" required>
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                  <p style="padding-top: 2%;" id="loc"></p>
                  <script>
                    var x = document.getElementById("loc");
                    var test_lat=null;
                    var test_lon=null;
              function getLocation()
              {
              if (navigator.geolocation)
              {
              navigator.geolocation.getCurrentPosition(showPosition);
              }
              else
              {
              x.innerHTML = "Geolocation is not supported by this browser.";
              }
              }
              function showPosition(position)
              {
              test_lat=position.coords.latitude;
              test_lon=position.coords.longitude;
              
              
              x.innerHTML= "Latitude: " + test_lat +"    "+"Longitude: " + test_lon;
              }
                  </script>
                </div>
              </div>

              <div class="form-row">
                <div class="col-lg-12 pt-3">
                  <button type="submit" value="Register" class="btn1" id="register">Register</button>
                </div>
              </div>

              <p style="padding-top: 2%;">Already have an account  <a href="{%  url 'login' %}">login here</a>
              </p>
            <!-- </form> -->
          </div>
        </center>
         
        </div>
      </div>
     </section> 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha3104-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>

    <script>
      var newUser = {'size':null,  'area':null,'role':null,'phone_no':null,'phone_no':null,'instituteName':null,'pincode':null,
      'state':null,  'city':null,'address':null,'labs':null,'rooms':null,'testcapacity':null,'estdyear':null,'lats':null, 'lons':null, 'cat':null}
      $('#test-size').on('keyup', function(){
        $('#error').hide()
        newUser.size= $(this).val()
        console.log(newUser)

    })

    $('#test-area').on('keyup', function(){
        $('#error').hide()
        newUser.area = $(this).val()
        console.log(newUser)

    })

    $('#test-role').on('keyup', function(){
        $('#error').hide()
        newUser.role = $(this).val()
        console.log(newUser)

    })

    $('#test-phone_no').on('keyup', function(){
        $('#error').hide()
        newUser.phone_no = $(this).val()
        console.log(newUser)

    })

    $('#test-instituteName').on('keyup', function(){
        $('#error').hide()
        newUser.instituteName = $(this).val()
        console.log(newUser)

    })

    $('#test-pincode').on('keyup', function(){
        $('#error').hide()
        newUser.pincode = $(this).val()
        console.log(newUser)

    })

    $('#test-state').on('keyup', function(){
        $('#error').hide()
        newUser.state= $(this).val()
        console.log(newUser)

    })

    $('#test-city').on('keyup', function(){
        $('#error').hide()
        newUser.city = $(this).val()
        console.log(newUser)

    })

    $('#test-address').on('keyup', function(){
        $('#error').hide()
        newUser.address= $(this).val()
        console.log(newUser)

    })

    $('#test-labs').on('keyup', function(){
        $('#error').hide()
        newUser.labs = $(this).val()
        console.log(newUser)

    })

    $('#test-rooms').on('keyup', function(){
        $('#error').hide()
        newUser.rooms = $(this).val()
        console.log(newUser)

    })

    $('#test-capacity').on('keyup', function(){
        $('#error').hide()
        newUser.capacity= $(this).val()
        console.log(newUser)

    })

    $('#test-estdyear').on('keyup', function(){
        $('#error').hide()
        newUser.estdyear = $(this).val()
        console.log(newUser)

    })
    $('#test-cat').on('keyup', function(){
        $('#error').hide()
        newUser.cat = $(this).val()
        console.log(newUser)

    })
    newUser.lats=test_lat;
    newUser.lons=test_lon;

      $('#register').on('click', function(){
        createUser()
        
      })


      function createUser(){
        var url ="/signup/"

        $.ajax({
            method:'POST',
            url:url,
            data:newUser,
           
            success:function(resp){
              if(resp.status =='failed'){
                alert(resp.msg)
                $('#error').show()
              }
              else{
                alert("User created successfully")
                window.location.href='/login/'
              }
            },
            
        })
      }
      
</script>
    
  </body>
</html>